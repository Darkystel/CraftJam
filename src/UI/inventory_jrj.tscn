[gd_scene load_steps=7 format=2]

[ext_resource path="res://assets/themes/crafting_menu_theme.tres" type="Theme" id=1]
[ext_resource path="res://src/UI/Panel_jrj_fixed.gd" type="Script" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Overlay

onready var inv = get_node(\"TabContainer/INVENTORY\")
onready var item_list = get_node(\"/TabContainer/INVENTORY/item_list\")
onready var craft_list = get_node(\"/TabContainer/CRAFT/items_list\")

onready var player_inventory = get_node(\"../../inventory\")

func _ready():
	get_tree().paused = true
	pass
	
	
func _unhandled_input(event):
	if event.is_action_pressed(\"escape\") or event.is_action_pressed(\"inventory\"):
		get_UI_controller().pop_overlay()
		get_tree().paused = false
		
		
		

func get_itemlist():
	return $TabContainer/INVENTORY/item_list
	
func get_craftlist():
	return $TabContainer/CRAFT/items_list

func update():
	for item in player_inventory.inventory:
			item_list.add_item(item.name,item.icon)
			craft_list.add_item(item.name,item.icon)"

[sub_resource type="GDScript" id=2]
script/source = "extends Tabs
"

[sub_resource type="GDScript" id=3]
script/source = "extends Panel

var item_selected

onready var inventory = get_node(\"../../../../../inventory\")

func update_item(item):
	$Panel2/item_name.text = item.name
	$Panel/item_texture.texture = item.icon
	$Panel3/item_description.text = item.description

func _on_item_list_item_selected(index):
	item_selected = inventory.inventory[index]
	update_item(item_selected)

"

[sub_resource type="GDScript" id=4]
script/source = "extends IMTabs

var item_selected
var row11
var row12
var row13
var row21
var row22
var row23
var row31
var row32
var row33

onready var inventory = get_node(\"../../../../inventory\")

func _physics_process(delta):
	if Input.is_action_just_pressed(\"inventory\") or Input.is_action_just_pressed(\"escape\"):
		update()

func _on_items_list_item_activated(index):
	item_selected = inventory.inventory[index]
	add_to_craft(item_selected)
	inventory.inventory.remove(index)
	inventory.item_list.clear()
	inventory.craft_list.clear()
	inventory.update()

func add_to_craft(item):
	if $Panel/item1.get_item_count() == 0:
		row11 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item1.add_item(\"\",item.icon)
		
	elif $Panel/item2.get_item_count() == 0:
		row12 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item2.add_item(\"\",item.icon)
		
	elif $Panel/item3.get_item_count() == 0:
		row13 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item3.add_item(\"\",item.icon)
		
	elif $Panel/item4.get_item_count() == 0:
		row21 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item4.add_item(\"\",item.icon)
		
	elif $Panel/item5.get_item_count() == 0:
		row22 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item5.add_item(\"\",item.icon)
	
	elif $Panel/item6.get_item_count() == 0:
		row23 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item6.add_item(\"\",item.icon)
	
	elif $Panel/item7.get_item_count() == 0:
		row31 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item7.add_item(\"\",item.icon)
		
	elif $Panel/item8.get_item_count() == 0:
		row32 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item8.add_item(\"\",item.icon)
		
	elif $Panel/item9.get_item_count() == 0:
		row33 = item
		inventory.craft_inventory.push_back(item)
		$Panel/item9.add_item(\"\",item.icon)
	else:
		print(\"full capacity\")

func row(item,index):
	if index == 0:
		row11 = item
	elif index == 1:
		row12 = item
	elif index == 2:
		row13 = item
	elif index == 3:
		row21 = item
	elif index == 4:
		row22 = item
	elif index == 5:
		row23 = item
	elif index == 6:
		row31 = item
	elif index == 7:
		row32 = item
	elif index == 8:
		row33 = item
		
		
func update():
	for i in range(0,9):
		if not inventory.craft_inventory.empty():
			if i == 0:
				if row11 != null:
					inventory.inventory.push_back(row11)
			elif i == 1:
				if row12 != null:
					inventory.inventory.push_back(row12)
			elif i == 2:
				if row13 != null:
					inventory.inventory.push_back(row13)
			elif i == 3:
				if row21 != null:
					inventory.inventory.push_back(row21)
			elif i == 4:
				if row22 != null:
					inventory.inventory.push_back(row22)
			elif i == 5:
				if row23 != null:
					inventory.inventory.push_back(row23)
			elif i == 6:
				if row31 != null:
					inventory.inventory.push_back(row31)
			elif i == 7:
				if row32 != null:
					inventory.inventory.push_back(row32)
			elif i == 8:
				if row33 != null:
					inventory.inventory.push_back(row33)
					
	for i in range(0,9):
		if not inventory.craft_inventory.empty():
			inventory.craft_inventory.remove(0)
"

[node name="inventory" type="Control"]
pause_mode = 2
anchor_right = 1.0
anchor_bottom = 1.0
theme = ExtResource( 1 )
script = SubResource( 1 )
__meta__ = {
"_edit_lock_": true
}

[node name="ColorRect" type="ColorRect" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
color = Color( 0, 0, 0, 1 )
__meta__ = {
"_edit_lock_": true
}

[node name="TabContainer" type="TabContainer" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0

[node name="INVENTORY" type="Tabs" parent="TabContainer"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_top = 18.0
rect_min_size = Vector2( 256, 126 )
script = SubResource( 2 )

[node name="item_description" type="Panel" parent="TabContainer/INVENTORY"]
editor/display_folded = true
anchor_left = 1.0
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
margin_left = -104.0
margin_top = -61.0
margin_right = -8.0
margin_bottom = 55.0
script = SubResource( 3 )

[node name="Panel" type="Panel" parent="TabContainer/INVENTORY/item_description"]
margin_left = 4.0
margin_top = 4.0
margin_right = 28.0
margin_bottom = 28.0

[node name="item_texture" type="TextureRect" parent="TabContainer/INVENTORY/item_description/Panel"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 4.0
margin_right = -4.0
margin_bottom = -4.0
stretch_mode = 1

[node name="Panel2" type="Panel" parent="TabContainer/INVENTORY/item_description"]
margin_left = 32.0
margin_top = 4.0
margin_right = 92.0
margin_bottom = 28.0

[node name="item_name" type="Label" parent="TabContainer/INVENTORY/item_description/Panel2"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 4.0
margin_right = -4.0
margin_bottom = -4.0
valign = 1
autowrap = true

[node name="Panel3" type="Panel" parent="TabContainer/INVENTORY/item_description"]
margin_left = 4.0
margin_top = 32.0
margin_right = 92.0
margin_bottom = 112.0

[node name="item_description" type="RichTextLabel" parent="TabContainer/INVENTORY/item_description/Panel3"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 4.0
margin_right = -4.0
margin_bottom = -4.0

[node name="item_list" type="ItemList" parent="TabContainer/INVENTORY"]
margin_left = 8.0
margin_top = 14.0
margin_right = 140.0
margin_bottom = 98.0
allow_reselect = true
fixed_icon_size = Vector2( 16, 16 )

[node name="Label" type="Label" parent="TabContainer/INVENTORY"]
margin_left = 8.0
margin_top = 2.0
margin_right = 140.0
margin_bottom = 10.0
text = "ITEMS"

[node name="equip" type="Button" parent="TabContainer/INVENTORY"]
margin_left = 8.0
margin_top = 102.0
margin_right = 44.0
margin_bottom = 118.0
focus_mode = 0
enabled_focus_mode = 0
text = "EQUIP"

[node name="use" type="Button" parent="TabContainer/INVENTORY"]
margin_left = 52.0
margin_top = 102.0
margin_right = 92.0
margin_bottom = 118.0
focus_mode = 0
enabled_focus_mode = 0
text = "USE"

[node name="drop" type="Button" parent="TabContainer/INVENTORY"]
margin_left = 100.0
margin_top = 102.0
margin_right = 140.0
margin_bottom = 118.0
focus_mode = 0
enabled_focus_mode = 0
text = "DROP"

[node name="CRAFT" type="Tabs" parent="TabContainer"]
visible = false
anchor_right = 1.0
anchor_bottom = 1.0
margin_top = 18.0
rect_min_size = Vector2( 256, 126 )
script = SubResource( 4 )

[node name="items_list" type="ItemList" parent="TabContainer/CRAFT"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -108.0
margin_top = -33.0
margin_right = -8.0
margin_bottom = 35.0
fixed_icon_size = Vector2( 16, 16 )

[node name="Label" type="Label" parent="TabContainer/CRAFT"]
margin_left = 20.0
margin_top = 18.0
margin_right = 120.0
margin_bottom = 26.0
text = "ITEMS"
valign = 1

[node name="Label2" type="Label" parent="TabContainer/CRAFT"]
margin_left = 133.581
margin_top = 6.06156
margin_right = 233.581
margin_bottom = 14.0616
text = "CRAFTING"
valign = 1

[node name="Panel" type="Panel" parent="TabContainer/CRAFT"]
margin_left = 132.0
margin_top = 14.0
margin_right = 218.0
margin_bottom = 100.0
script = ExtResource( 2 )

[node name="item1" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 4.0
margin_top = 3.0
margin_right = 28.0
margin_bottom = 27.0
grow_horizontal = 0
grow_vertical = 0
rect_min_size = Vector2( 20, 20 )
same_column_width = true
fixed_column_width = 16
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item2" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 31.0
margin_top = 3.0
margin_right = 55.0
margin_bottom = 27.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item3" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 58.0
margin_top = 3.0
margin_right = 82.0
margin_bottom = 27.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item4" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 4.0
margin_top = 30.0
margin_right = 28.0
margin_bottom = 54.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item5" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 31.0
margin_top = 30.0
margin_right = 55.0
margin_bottom = 54.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item6" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 58.0
margin_top = 30.3059
margin_right = 82.0
margin_bottom = 54.3059
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item7" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 4.0
margin_top = 57.0
margin_right = 28.0
margin_bottom = 81.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item8" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 31.0
margin_top = 57.0
margin_right = 55.0
margin_bottom = 81.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="item9" type="ItemList" parent="TabContainer/CRAFT/Panel"]
margin_left = 58.0
margin_top = 57.0
margin_right = 82.0
margin_bottom = 81.0
icon_mode = 0
fixed_icon_size = Vector2( 16, 16 )

[node name="craft" type="Button" parent="TabContainer/CRAFT"]
margin_left = 178.786
margin_top = 104.22
margin_right = 214.786
margin_bottom = 120.22
focus_mode = 0
enabled_focus_mode = 0
text = "CRAFT"

[node name="reset" type="Button" parent="TabContainer/CRAFT"]
margin_left = 132.752
margin_top = 103.809
margin_right = 168.752
margin_bottom = 119.809
focus_mode = 0
enabled_focus_mode = 0
text = "RESET"
[connection signal="tab_changed" from="TabContainer" to="TabContainer/CRAFT" method="_on_TabContainer_tab_changed"]
[connection signal="tab_changed" from="TabContainer" to="TabContainer/INVENTORY" method="_on_TabContainer_tab_changed"]
[connection signal="item_selected" from="TabContainer/INVENTORY/item_list" to="TabContainer/INVENTORY/item_description" method="_on_item_list_item_selected"]
[connection signal="item_activated" from="TabContainer/CRAFT/items_list" to="TabContainer/CRAFT" method="_on_items_list_item_activated"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item1" to="TabContainer/CRAFT/Panel" method="_on_item1_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item1" to="TabContainer/CRAFT/Panel" method="_on_item1_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item2" to="TabContainer/CRAFT/Panel" method="_on_item2_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item2" to="TabContainer/CRAFT/Panel" method="_on_item2_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item3" to="TabContainer/CRAFT/Panel" method="_on_item3_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item3" to="TabContainer/CRAFT/Panel" method="_on_item3_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item4" to="TabContainer/CRAFT/Panel" method="_on_item4_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item4" to="TabContainer/CRAFT/Panel" method="_on_item4_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item5" to="TabContainer/CRAFT/Panel" method="_on_item5_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item5" to="TabContainer/CRAFT/Panel" method="_on_item5_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item6" to="TabContainer/CRAFT/Panel" method="_on_item6_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item6" to="TabContainer/CRAFT/Panel" method="_on_item6_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item7" to="TabContainer/CRAFT/Panel" method="_on_item7_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item7" to="TabContainer/CRAFT/Panel" method="_on_item7_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item8" to="TabContainer/CRAFT/Panel" method="_on_item8_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item8" to="TabContainer/CRAFT/Panel" method="_on_item8_mouse_exited"]
[connection signal="mouse_entered" from="TabContainer/CRAFT/Panel/item9" to="TabContainer/CRAFT/Panel" method="_on_item9_mouse_entered"]
[connection signal="mouse_exited" from="TabContainer/CRAFT/Panel/item9" to="TabContainer/CRAFT/Panel" method="_on_item9_mouse_exited"]
